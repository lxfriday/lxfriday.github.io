---
title: 小程序自定义导航条之后自己设计左侧胶囊按钮需要在不同平台适配
comments: true
date: 2018-09-02 08:33:09
categories: 微信小程序
tags: 踩坑
---

小程序如果自定义了导航条，原有导航条会消失，只剩下右侧的两个胶囊按钮。

自定义左侧的按钮采用绝对定位，但是在两个平台上使用同一套样式，会导致胶囊按钮在一个平台上大小位置合适，另一个平台上大小位置却不合适。

所以 **需要先判断平台类型，依据平台显示不同的样式**。


```vue
// vue 文件
<template>
  <div class="container">
    <div :class="'navigateWrapper ' + goBackClass" @click="handleNavigateBack">
      <img src="/static/icons/arrow_back.png" class="navigateBackImage">
    </div>
  </div>
</template>

<script>
  import indexStore from '../index/store';
  export default {
    data() {
      return {};
    },
    computed: {
      // 依据平台显示不同的class
      goBackClass() {
        return indexStore.state.systemType;
      },
    },
    methods: {
      handleNavigateBack() {
        wx.navigateBack();
      },
    },
  };
</script>

<style lang="less" scoped>
  .container {
    height: 100vh;
    .ios {
      left: 6px;
      top: 24px;
      height: 30px;
    }
    .android {
      left: 10px;
      top: 34px;
      height: 32px;
    }
    .navigateWrapper {
      position: absolute;
      z-index: 999;
      width: 45px;
      border-radius: 24px;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: rgba(0,0,0,.1);
      border: 0.1px solid rgba(255,255,255,.2);
      .navigateBackImage {
        width: 18px;
        height: 18px;
        border-radius: 50%;
      }
    }
  }
</style>
```


```js
// store，进入小程序的时候，获取到手机的系统类型
import Vuex from 'vuex';
import Vue from 'vue';

import { GET_SYSTEM_TYPE } from '@/store/mutation-types';

Vue.use(Vuex);

const initialState = () => ({
  systemType: 'android', // 系统类型， ios or android
});

const store = new Vuex.Store({
  state: {
    ...initialState(),
  },
  mutations: {
    [GET_SYSTEM_TYPE]: (state, { payload }) => {
      const obj = state;
      obj.systemType = payload;
    },
  },
  actions: {
    async [GET_SYSTEM_TYPE]({ commit }, { payload }) {
      commit({
        type: GET_SYSTEM_TYPE,
        payload,
      });
    },
  },
});

export default store;
```

```js
// 获取手机系统类型

import { GET_SYSTEM_TYPE } from '@/store/mutation-types';
import indexStore from './store';

function getSystemInfo() {
  wx.getSystemInfo({
    success(res) {
      const systemTypeStr = res.system.toLowerCase();
      if (systemTypeStr.includes('ios')) {
        indexStore.dispatch({
          type: GET_SYSTEM_TYPE,
          payload: 'ios',
        });
      } else {
        indexStore.dispatch({
          type: GET_SYSTEM_TYPE,
          payload: 'android',
        });
      }
    },
    fail() {
      indexStore.dispatch({
        type: GET_SYSTEM_TYPE,
        payload: 'android',
      });
    },
  });
}
```
